{% extends "base.html" %}

{% block content %}
<h1 class="mb-4">Worker details</h1>

<div class="card mb-4">
  <div class="card-body">
    <h3 class="card-title">{{ object.username }}</h3>

    <p class="mb-1">
      <strong>Full name:</strong>
      {% if object.first_name or object.last_name %}
        {{ object.first_name }} {{ object.last_name }}
      {% else %}
        <em>Not provided</em>
      {% endif %}
    </p>

    <p class="mb-1">
      <strong>Email:</strong>
      {% if object.email %}
        {{ object.email }}
      {% else %}
        <em>Not provided</em>
      {% endif %}
    </p>

    <p class="mb-0">
      <strong>Position:</strong>
      {% if object.position %}
        {{ object.position.name }}
      {% else %}
        <em>No position</em>
      {% endif %}
    </p>
  </div>
</div>

<h3 class="mb-3">Assigned tasks</h3>

<table class="table table-striped table-hover align-middle">
  <thead class="table-dark">
    <tr>
      <th>ID</th>
      <th>Name</th>
      <th>Status</th>
      <th>Priority</th>
      <th>Deadline</th>
    </tr>
  </thead>

  <tbody>
  {% for task in object.assigned_tasks.all %}
    <tr>
      <td>{{ task.id }}</td>

      <td>
        <a href="{% url 'app:tasks-detail' task.pk %}">
          {{ task.name }}
        </a>
      </td>

      <td>
        {% if task.is_complete %}
          <span class="badge bg-success">Completed</span>
        {% else %}
          <span class="badge bg-warning text-dark">In progress</span>
        {% endif %}
      </td>

      <td>
        {{ task.get_priority_display }}
      </td>

      <td>
        {{ task.deadline|date:"Y-m-d H:i" }}
      </td>
    </tr>
  {% empty %}
    <tr>
      <td colspan="5" class="text-center">
        <em>No assigned tasks</em>
      </td>
    </tr>
  {% endfor %}
  </tbody>
</table>

<a href="{% url 'app:tasks' %}" class="btn btn-secondary">
  ‚Üê Back to tasks
</a>

<a href="{% url 'app:workers-update' object.id  %}" class="btn btn-success link-to-form">
    Update
</a>

<a href="{% url 'app:workers-delete' object.id  %}" class="btn btn-danger link-to-form">
    Delete
</a>

{% endblock %}
