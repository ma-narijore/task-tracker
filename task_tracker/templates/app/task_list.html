{% extends "base.html" %}

{% block content %}
<h1 class="mb-4">
  Tasks
  <a href="{% url 'app:tasks-create' %}" class="btn btn-primary link-to-page">
    Create
  </a>
</h1>

<table class="table table-striped table-hover align-middle">
  <thead class="table-dark">
  <tr>
    <th>ID</th>
    <th>Name</th>
    <th>Description</th>
    <th>Status</th>
    <th>Priority</th>
    <th>Type</th>
    <th>Assigned to</th>
  </tr>
  </thead>

  <tbody>
  {% for task in object_list %}
  <tr>
    <td>{{ task.id }}</td>

    <td>
      <a href="{% url 'app:tasks-detail' task.pk %}">
        {{ task.name }}
      </a>
    </td>

    <td>
      {{ task.description|truncatechars:60 }}
    </td>

    <td>
      {% if task.is_complete %}
      <span class="badge bg-success">Completed</span>
      {% else %}
      <span class="badge bg-warning text-dark">In progress</span>
      {% endif %}
    </td>

    <td>
      {{ task.get_priority_display }}
    </td>

    <td>
      {% if task.task_type %}
      {{ task.task_type.name }}
      {% else %}
      <em>â€”</em>
      {% endif %}
    </td>

    <td>
      {% for worker in task.assignees.all %}
      <a href="{% url 'app:workers-detail' worker.pk %}">
        {{ worker.username }}
      </a>{% if not forloop.last %}, {% endif %}
      {% empty %}
      <em>No assignees</em>
      {% endfor %}
    </td>
  </tr>
  {% empty %}
  <tr>
    <td colspan="7" class="text-center">
      <em>No tasks found</em>
    </td>
  </tr>
  {% endfor %}
  </tbody>
</table>
{% endblock %}
