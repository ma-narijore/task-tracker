{% extends "base.html" %}

{% block content %}
<h1 class="mb-4">
  Workers
  <a href="{% url 'app:workers-create' %}" class="btn btn-primary link-to-page">
    Add Worker
  </a>
</h1>

<table class="table table-striped table-hover align-middle">
  <thead class="table-dark">
  <tr>
    <th>ID</th>
    <th>Username</th>
    <th>Position</th>
    <th>Email</th>
    <th>Assigned tasks</th>
  </tr>
  </thead>

  <tbody>
  {% for worker in object_list %}
  <tr>
    <td>{{ worker.id }}</td>

    <td>
      <a href="{% url 'app:workers-detail' worker.pk %}">
        {{ worker.username }}
      </a>
    </td>

    <td>
      {% if worker.position %}
      {{ worker.position.name }}
      {% else %}
      <em>—</em>
      {% endif %}
    </td>

    <td>
      {% if worker.email %}
      {{ worker.email }}
      {% else %}
      <em>—</em>
      {% endif %}
    </td>

    <td>
      {% for task in worker.assigned_tasks.all %}
      <a href="{% url 'app:tasks-detail' task.pk %}">
        {{ task.name }}
      </a>
      <small class="text-muted">
        (Deadline: {{ task.deadline|date:"Y-m-d" }})
      </small>
      {% if not forloop.last %}<br>{% endif %}
      {% empty %}
      <em>No assigned tasks</em>
      {% endfor %}
    </td>
  </tr>
  {% empty %}
  <tr>
    <td colspan="5" class="text-center">
      <em>No workers found</em>
    </td>
  </tr>
  {% endfor %}
  </tbody>
</table>

{% endblock %}
